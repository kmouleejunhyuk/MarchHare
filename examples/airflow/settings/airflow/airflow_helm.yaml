########################################
## CONFIG | Airflow Configs
########################################
airflow:
  ## if we use legacy 1.10 airflow commands
  legacyCommands: false

  ## configs for the airflow container image
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/configuration/airflow-version.md
  image:
    repository: apache/airflow
    tag: 2.2.5-python3.8

  ## the airflow executor type to use
  executor: KubernetesExecutor

  ## the fernet encryption key (sets `AIRFLOW__CORE__FERNET_KEY`)
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/security/set-fernet-key.md
  ## [WARNING] change from default value to ensure security
  fernetKey: "7T512UXSSmBOkpWimFHIVb8jK6lfmSAvx4mO6Arehnc="

  ## the secret_key for flask (sets `AIRFLOW__WEBSERVER__SECRET_KEY`)
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/security/set-webserver-secret-key.md
  ## [WARNING] change from default value to ensure security
  webserverSecretKey: "THIS IS UNSAFE!"

  ## environment variables for airflow configs
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/configuration/airflow-configs.md
  config:
    AIRFLOW__WEBSERVER__EXPOSE_CONFIG: "True"
    AIRFLOW__CORE__LOAD_EXAMPLES: "False"

  ## a list of users to create
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/security/airflow-users.md
  users:
    - username: admin
      password: admin
      role: Admin
      email: admin@example.com
      firstName: admin
      lastName: admin
    - username: junhyeok
      password: 33999
      role: Admin
      email: ksi03376@naver.com
      firstName: junhyeok
      lastName: lee

  ## a list airflow connections to create
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/dags/airflow-connections.md
  connections: []

  ## a list airflow variables to create
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/dags/airflow-variables.md
  variables: []

  ## a list airflow pools to create
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/dags/airflow-pools.md
  pools: []

  ## extra pip packages to install in airflow Pods
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/configuration/extra-python-packages.md
  ## [WARNING] this feature is not recommended for production use, see docs
  extraPipPackages: []

  ## extra environment variables for the airflow Pods
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-environment-variables.md
  extraEnv: []

  ## extra VolumeMounts for the airflow Pods
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-persistent-volumes.md
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-files.md
  extraVolumeMounts: []

  ## extra Volumes for the airflow Pods
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-persistent-volumes.md
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-files.md
  extraVolumes: []

  ## configs generating the `pod_template.yaml` file for `AIRFLOW__KUBERNETES__POD_TEMPLATE_FILE`
  ## [NOTE] the `dags.gitSync` values will create a git-sync init-container in the pod
  ## [NOTE] the `airflow.extraPipPackages` will NOT be installed
  kubernetesPodTemplate:

    ## the full content of the pod-template file (as a string)
    ## [NOTE] all other `kubernetesPodTemplate.*` are disabled when this is set
    stringOverride: ""

    ## resource requests/limits for the Pod template "base" container
    ## [SPEC] https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#resourcerequirements-v1-core
    resources: {}

    ## extra pip packages to install in the Pod template
    ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/configuration/extra-python-packages.md
    ## [WARNING] this feature is not recommended for production use, see docs
    extraPipPackages: []

    ## extra VolumeMounts for the Pod template
    ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-persistent-volumes.md
    ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-files.md
    extraVolumeMounts: []

    ## extra Volumes for the Pod template
    ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-persistent-volumes.md
    ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/mount-files.md
    extraVolumes: []

###################################
## COMPONENT | Airflow Scheduler
###################################
scheduler:
  ## the number of scheduler Pods to run
  replicas: 1

  ## resource requests/limits for the scheduler Pods
  ## [SPEC] https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#resourcerequirements-v1-core
  resources: {}

  ## configs for the log-cleanup sidecar of the scheduler
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/monitoring/log-cleanup.md
  logCleanup:
    enabled: true
    retentionMinutes: 21600

  ## configs for the scheduler Pods' liveness probe
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/monitoring/scheduler-liveness-probe.md
  livenessProbe:
    enabled: true

    ## configs for an additional check that ensures tasks are being created by the scheduler
    ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/monitoring/scheduler-liveness-probe.md
    taskCreationCheck:
      enabled: false
      thresholdSeconds: 300
      schedulerAgeBeforeCheck: 180

###################################
## COMPONENT | Airflow Webserver
###################################
web:
  ## the number of web Pods to run
  replicas: 1

  ## resource requests/limits for the web Pods
  ## [SPEC] https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#resourcerequirements-v1-core
  resources: {}

  ## configs for the Service of the web Pods
  service:
    type: ClusterIP
    externalPort: 8080

  ## configs generating the `webserver_config.py` file
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/configuration/airflow-configs.md#webserver_configpy
  webserverConfig:
    ## the full content of the `webserver_config.py` file (as a string)
    stringOverride: |
      from airflow import configuration as conf
      from flask_appbuilder.security.manager import AUTH_DB
      
      # the SQLAlchemy connection string
      SQLALCHEMY_DATABASE_URI = conf.get("core", "SQL_ALCHEMY_CONN")
      
      # use embedded DB for auth
      AUTH_TYPE = AUTH_DB
    ## the name of a Secret containing a `webserver_config.py` key
    existingSecret: ""

###################################
## COMPONENT | Airflow Workers
###################################
workers:
  ## if the airflow workers StatefulSet should be deployed
  enabled: false

###################################
## COMPONENT | Triggerer
###################################
triggerer:
  ## if the airflow triggerer should be deployed
  enabled: true

  ## the number of triggerer Pods to run
  replicas: 1

  ## resource requests/limits for the triggerer Pods
  ## [SPEC] https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#resourcerequirements-v1-core
  resources: {}

  ## maximum number of triggers each triggerer will run at once (sets `AIRFLOW__TRIGGERER__DEFAULT_CAPACITY`)
  capacity: 1000

###################################
## COMPONENT | Flower
###################################
flower:
  ## if the airflow flower UI should be deployed
  enabled: false

###################################
## CONFIG | Airflow Logs
###################################
logs:
  ## the airflow logs folder
  path: /opt/airflow/logs

  ## configs for the logs PVC
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/monitoring/log-persistence.md
  persistence:
    enabled: false

###################################
## CONFIG | Airflow DAGs
###################################
dags:
  ## the airflow dags folder
  path: /opt/airflow/dags

  ## configs for the dags PVC
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/dags/load-dag-definitions.md
  persistence:
    enabled: false

  ## configs for the git-sync sidecar
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/dags/load-dag-definitions.md
  gitSync:
    enabled: true
    repo: https://github.com/kmouleejunhyuk/MarchHare.git
    branch: nightly
    subPath: ""
    sshKeySecret: airflow-ssh-secret
    extraSecrets:
      airflow-ssh-secret:
        data: |
          gitSshKey: 'LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUNGd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFnRUF6Wm1tY2FUREUzZDl0Y1Voa0M4ZS80bUpjVk5qWEJJa2RMc0VNR2FmSGkwTU9RRktvemxoCkFaZk1VM3dCSzlycitROG5jQTBBRklpcXJmL1VmSnozWHMxWUQ3T3UvZVF5c2V5ZkFTNWF4MmtoYU9kWlNKcmhyUlFqb3cKRnFwaURGY0Y4NVVUV1d5SmpVaGNtVi91S1JDNTRGeXcxcndrcVkwU2lFV3ByS3Z5Q2dhbDF0RitnNXNHd0cyWW1xcExOcwpRRnpKa3Npbm81WWNsZGwyNmdvWWh4c1lXdnVHU1hIZW5ibjBHYzd2U3RrNVYxSWU1UGVyTkJGYlQrUDFYRWlVTGlLVmUzCnJKWWgyZTdvdGViVFFYZFVsMUZYOGc3Wnl4NkNEN2FETlIwcHhRWlRBUWxuNXgyWVZOYkZvYlBvS0U4RjhyUnhvYkV5WkIKTGZ1YkNVajh6ei95SGhnaGkyK2hGSWJ3TjhJRWt6a2txVHpSSFJCdG9pdlAwWERidjcxN0N1R1BiakY3UlBtMGo0dExjSApqaVhSS2h3bXhSTTVTWnAvNlZ6T2dDZkhPRGhyUXcvWE1sa1ZvbmdPU1ZPaDZmaE5oSU5DQ3Y0NnIzbWFiQ0FOK2tYcHc0ClZXc2Q2d1NHaEI0QTNnOHF2Q1BqR3FrTVlNdXl1ODZjVFFUR2lPdmNyQ0o0L3NGTytCbDh5Y01xc25uZHVBYjg5dGREY1QKRVNUMUZCelN3di9paHNzV3N6Y0xxWG5NaGdpWGNzYThQOSsvc0FyVjRneHhJZURNNnVWanNDaWJHeGI4YVErRTZjVGpRYgpTYzRjQUd4K1RNWENJeEhFRnJTdlNFeXNwVU5IK0IvZEcxdTIySTVxYTBSTWpacGp6ek1hdm9iQzZVbUdSRTh5WUJtei9VCmNBQUFkSUZZM2pIUldONHgwQUFBQUhjM05vTFhKellRQUFBZ0VBelptbWNhVERFM2Q5dGNVaGtDOGUvNG1KY1ZOalhCSWsKZExzRU1HYWZIaTBNT1FGS296bGhBWmZNVTN3Qks5cnIrUThuY0EwQUZJaXFyZi9VZkp6M1hzMVlEN091L2VReXNleWZBUwo1YXgya2hhT2RaU0pyaHJSUWpvd0ZxcGlERmNGODVVVFdXeUpqVWhjbVYvdUtSQzU0Rnl3MXJ3a3FZMFNpRVdwckt2eUNnCmFsMXRGK2c1c0d3RzJZbXFwTE5zUUZ6SmtzaW5vNVljbGRsMjZnb1loeHNZV3Z1R1NYSGVuYm4wR2M3dlN0azVWMUllNVAKZXJOQkZiVCtQMVhFaVVMaUtWZTNySlloMmU3b3RlYlRRWGRVbDFGWDhnN1p5eDZDRDdhRE5SMHB4UVpUQVFsbjV4MllWTgpiRm9iUG9LRThGOHJSeG9iRXlaQkxmdWJDVWo4enoveUhoZ2hpMitoRklid044SUVremtrcVR6UkhSQnRvaXZQMFhEYnY3CjE3Q3VHUGJqRjdSUG0wajR0TGNIamlYUktod214Uk01U1pwLzZWek9nQ2ZIT0RoclF3L1hNbGtWb25nT1NWT2g2ZmhOaEkKTkNDdjQ2cjNtYWJDQU4ra1hwdzRWV3NkNndTR2hCNEEzZzhxdkNQakdxa01ZTXV5dTg2Y1RRVEdpT3ZjckNKNC9zRk8rQgpsOHljTXFzbm5kdUFiODl0ZERjVEVTVDFGQnpTd3YvaWhzc1dzemNMcVhuTWhnaVhjc2E4UDkrL3NBclY0Z3h4SWVETTZ1ClZqc0NpYkd4YjhhUStFNmNUalFiU2M0Y0FHeCtUTVhDSXhIRUZyU3ZTRXlzcFVOSCtCL2RHMXUyMkk1cWEwUk1qWnBqenoKTWF2b2JDNlVtR1JFOHlZQm16L1VjQUFBQURBUUFCQUFBQ0FFN2VSZzhLR1JyNmwycUcrRjBLOW1Vb0tXVWppOVhoejhKSAppMC9WemV3UmM4TGFUL3RWSTNVcytlQjhqU1o1a0ZPMkVIYlhSZFNhcUg2ZXlMQVV0bi9UWFppSVlQUmIrV1p2VW45dGZMCjFLQXRydkJEenB6UEJMN1crMk4yY0s0ekk4RlF5bDlmVjFTdkVYWjBhak91aXQ4YUwydndPRkFpSVozTXUwM1ZsNzlvMVcKMFdaK1dzTG1iYW85T1F4OUYyV0pNbm53SnY2RnN1bDR4amo1TG5lRldVNXRkaEh1Y0dzb3pnNm9adnJiWVRleDlNLzRnZQpBeldFZkpObkgwRllPdEdKS0pnMzd6eGVmVDVxRVZmbm9yZDVLTGRlSXdYYjZpQ0U3c2dOSzl5OGxGS3RmUUlYUkR3bk55CkRVbHBYLzJsUkVDK0x1eWxuQk03bFRsMm1pTm1YNUVtNFRuaWh3QWhTV2xJR0hFMDVrR0RnT0p5UGkyWFROd25udGR1UkEKWEZmY3VqeVJqSEUySHR3NWlyYzZFMEdJcmZWMVAvU09odHExbFZSYzl3V2tEdmVBV3BhMDdHcjdPTTc1LzgwNjFza2QxRApuU0NadEpNRkhmam5UTHAzVnBzT1pqNVU1MU1jSmpWYW5hOXpZcHFsL2VGSVc4NjRZTTVsWU1FVkV2blF2NGoydE9ET1k3Cmo3R1hHQnp0UFk4M2h0bGVaV051K2NaT2wveEFJRFJRMllTZ0ZrdXlvRzF3YU5NTUVzTlRxVGY4UUdDeTNmcGk2R01scDYKNmVIKzkwUXVHaG1OeUpPNSsvNi9GdDNLcktLbVpKSEk0QXdqMnI3WDdjdllkVFprVW5lQmx2d2J5aFVESGNtWDJTdUZmVQpZdDdYTmZXUXRFZXcvMXJ1cGhBQUFCQVFER3A2cjdYdlFiOTZQQmVIUDMrZXF1emZKaW1TU2tCZ0c4dVVDWk5zcU9zTm5tClZXc1g0RUUyZ1F1TEQwaXI5Z1ZOc242K1hXRFJRWWphalZBOWVJcmRYZERITVgyTHkveEJOd1FKUFdzb3kzOG5kLzdQLzQKUzBKVWFvZ0N1N01ybWp3YUprSm1uTDVuSVlxa21Ud1hZa1dBNVJxNHhFRjJKZWRMblpEYWFSTU9iYXFZeDc3emhKUE1PMQp3MnhZZHlvQUNBTkVJeW10dmpIaFdlQ3JuQktlcEVuRnpxUnMrMjBXRFZCNW9CdGZ2UzF4L3Ywb2ZYWEdFcEpWMDNreGpnCjlvTUtYOExsWk9uV3RHQm5WR3dpWUVwR0o2bmhIK3ljajgycnR6ZUd1eXR2aDFvR0Y3MzZ1RnE3SUNFcTFRd1oxS2ZRZlAKQ216Q2puNjZhalNnN3RsdUFBQUJBUURyQndlMmNuV1l6eU9mVjF3WlpxNFNKL2xUdXF2ckdmRU5WNWJveG1zZ1RocENGMApHN3MzY1VEY2J1RmYxQUthOXFIMW1zRUJ3MVZzSW5sY2hWRmV0Z3ZOT0tXV21KNlFjLzZmbys0VEJNNkRqL252U1RUSzlNClF6U0RjRGN0NWg0SXhjN0dtWE5EVUtwYmJqWkJSRnlkVjhNdFZST0toQlZCV1FaQmVJQWpLdU1Sd3hPNVBhNkZZZHdBbzIKYWVRcEZkZ1ZjRnN4VW9sNWJoRHhvWllSOVFjaDc3NlhKR2dqaHFxODF5SCtTbXZvL0xyeEovQVhINVZtcXNyYmVXS0hXSwpXTW9KSENlRTJSR1BqUkRBTkg0Mml5MU9Ic05ORmNoajh6V1lUT1ZnRFUvYTcybUtYRlJRbUdiYTBPQ3g1Y3JxaVZybEZ0CjZqUzk5VWJYRld5YXhkQUFBQkFRRGY4bUllTlNxOHM3RGZCeGZZVmtaeWQvK3Z0blV2NlMzODdCM1BpWXhkV3E1MWVyQUMKRGJ3M3VZS1ZrNDZGaWVsVlVTekJDK2IwdlBsbjJGQjk2a2RKTFQvcVZORWR6NzRZeWh3V0ROMS9rQ3UwMHdVLytQazlOZwptT01KeU01NmlheEtobUx6VmUwM0UwNU5aUHpjQUNMM2g0VkhQdFdFbTR6MTJzTis2ODEwVWpNR3dXaktEcVNkdTZScVlMCnYyMGhaNUgxZ2FmMHl2d0U4aFJWbDlMVnllM25wK2VUTW5KUkVZSHZENDhCcGRYQkorWitCcEY1TVJEcmRCWjIzS0swNnUKSTJoMjc5OVpEdWh3dnV4TXZNTDFvWEp2b2dvb1lvNlFONy9wczB1UTlqQlVlMTZtZXpib3F4WXh0YlB5SVNkOFd1Yk1XUApWU0R4RjVLOWpOWHpBQUFBRW10emFUQXpNemMyUUc1aGRtVnlMbU52YlE9PQotLS0tLUVORCBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K'

###################################
## CONFIG | Kubernetes Ingress
###################################
ingress:
  ## if we should deploy Ingress resources
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/ingress.md
  enabled: false

###################################
## CONFIG | Kubernetes ServiceAccount
###################################
serviceAccount:
  ## if a Kubernetes ServiceAccount is created
  create: true

  ## the name of the ServiceAccount
  name: ""

  ## annotations for the ServiceAccount
  annotations: {}

###################################
## CONFIG | Kubernetes Extra Manifests
###################################

## a list of extra Kubernetes manifests that will be deployed alongside the chart
## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/kubernetes/extra-manifests.md
extraManifests: []

###################################
## DATABASE | PgBouncer
###################################
pgbouncer:
  ## if the pgbouncer Deployment is created
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/database/pgbouncer.md
  enabled: true

  ## resource requests/limits for the pgbouncer Pods
  ## [SPEC] https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/#resourcerequirements-v1-core
  resources: {}

  ## sets pgbouncer config: `auth_type`
  authType: md5

###################################
## DATABASE | Embedded Postgres
###################################
postgresql:
  ## if the `stable/postgresql` chart is used
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/database/embedded-database.md
  ## [WARNING] the embedded Postgres is NOT SUITABLE for production deployments of Airflow
  ## [WARNING] consider using an external database with `externalDatabase.*`
  enabled: true

  ## configs for the PVC of postgresql
  persistence:
    enabled: true
    storageClass: ""
    size: 8Gi

  volumePermissions:
            enabled: true

###################################
## DATABASE | External Database
###################################
externalDatabase:
  ## the type of external database
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/database/external-database.md
  type: postgres

###################################
## DATABASE | Embedded Redis
###################################
redis:
  ## if the `stable/redis` chart is used
  enabled: false

###################################
## DATABASE | External Redis
###################################
externalRedis:
  ## the host of the external redis
  ## [FAQ] https://github.com/airflow-helm/charts/blob/main/charts/airflow/docs/faq/database/external-redis.md
  host: localhost
